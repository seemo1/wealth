<div ng-controller="CommonBundleController as bundle" ng-init="bundle.loadInfo()">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">Bundle Plus</h3>
        </div>
        <div class="panel-body">
            <div class="row">
                <form class="form-inline">
                    <div class="col-md-3 col-xs-3">
                        <div class="form-group input-group-sm">
                            <label for="type">Type</label>
                            <select class="form-control"
                                    id="type"
                                    ng-model="bundle.type"
                                    ng-change="bundle.loadInfo()">
                                <option ng-repeat="type in bundle.types">{{type}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-4 col-xs-4"
                         ng-hide="bundle.type == 'Language'">
                        <div class="form-group input-group-sm">
                            <label for="product">Product</label>
                            <select class="form-control"
                                    id="product"
                                    ng-model="bundle.product"
                                    ng-change="bundle.loadInfo()">
                                <option ng-repeat="product in bundle.products">{{product}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-3 col-xs-3"
                         ng-hide="bundle.type == 'Language' || bundle.type == 'Product'">
                        <div class="form-group input-group-sm">
                            <label for="platform">Platform</label>
                            <select class="form-control"
                                    id="platform"
                                    ng-model="bundle.platform"
                                    ng-change="bundle.loadInfo()">
                                <option ng-repeat="platform in bundle.platforms">{{platform}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-2 col-xs-2" ng-hide="bundle.type=='Version' || bundle.type=='Product'">
                        <div class="form-group input-group-sm">
                            <label for="lang">Language</label>
                            <select class="form-control"
                                    id="lang"
                                    ng-change="bundle.loadInfo()"
                                    ng-model="bundle.language">
                                <option ng-repeat="language in bundle.languages">{{language}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-4 col-xs-4"
                         ng-show="bundle.type == 'Product'">
                        <div class="form-group input-group-sm">
                            <label for="product">Stage</label>
                            <select class="form-control"
                                    id="stage"
                                    ng-model="bundle.stage"
                                    ng-change="bundle.loadInfo()">
                                <option ng-repeat="stage in bundle.stages">{{stage}}</option>
                            </select>
                        </div>
                    </div>

                </form>
            </div>
            <div class="row" ng-show="bundle.type == 'Version'">
                <br>
                <div class="col-xs-12 col-md-12">
                    <div class=" well well-lg">
                        <h4 class="text-primary">Add version</h4>

                        <div class="input-group input-group-sm">
                        <span class="input-group-addon">
                            <select ng-model="bundle.environment">
                                <option ng-repeat="env in bundle.environments">{{env}}</option>
                            </select>
                        </span>
                            <input type="text" class="form-control" ng-model='bundle.newVersion'
                                   placeholder="New Version Number">
                        <span class="input-group-btn">
                            <button class="btn btn-primary" type="button" ng-click="bundle.addVersion()">
                                Add Version
                            </button>
                        </span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <br>

                <div class="col-xs-12 col-md-12">
                    <div class=" well well-lg">
                        <h4 class="text-primary">Upload bundle</h4>

                        <div class="input-group input-group-sm">
                        <span class="input-group-addon">
                            Select environment:
                            <select id="newBundleEnvironment" ng-model="bundle.update.bundle.environment">
                                <option ng-repeat="env in bundle.environments">{{env}}</option>
                            </select>
                        </span>
                        <span class="input-group-addon" ng-show="bundle.type === 'Version'">
                            Select version:
                            <select id="updateVersion" ng-model="bundle.version">
                                <option ng-repeat="v in bundle.versions">{{v.version}}</option>
                            </select>
                        </span>
                        <span class="input-group-addon" ng-show="bundle.type === 'Version'">
                            Select language:
                            <select id="updateLanguage" ng-model="bundle.language">
                                <option ng-repeat="lang in bundle.languages">{{lang}}</option>
                            </select>
                        </span>
                            <input type="file" class="form-control" file-model="newBundleFile">
                        <span class="input-group-btn">
                            <button class="btn btn-primary" type="button" ng-click="bundle.uploadBundle()">
                                Upload Bundle
                            </button>
                        </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="panel panel-default" ng-if="bundle.type !== 'Version'">
        <div class="panel-heading clearfix">
            <h4 class="panel-title pull-left">&nbsp;&nbsp;File list</h4>
        </div>
        <div class="panel-body">
            <table class="table table-striped table-hover">
                <thead>
                <tr>
                    <th>#</th>
                    <th ng-if="bundle.type !== 'Language'">Product</th>
                    <th ng-if="bundle.type === 'Device'">Platform</th>
                    <th>File name</th>
                    <th>Environment</th>
                    <th ng-hide="bundle.type === 'Product'">Language</th>
                    <th>MD5</th>
                    <th>Last update time</th>
                    <th class="text-center">Download</th>
                    <th>Copy File</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="list in bundle.fileList track by $index">
                    <td>{{$index + 1}}</td>
                    <td ng-if="bundle.type !== 'Language'">{{list.product}}</td>
                    <td ng-if="bundle.type === 'Device'">{{list.platform}}</td>
                    <td>{{list.file_name}}</td>
                    <td>{{list.environment}}</td>
                    <td ng-hide="bundle.type === 'Product'">{{list.language}}</td>
                    <td>{{list.file_md5}}</td>
                    <td>{{list.last_update_time}}</td>
                    <td class="text-center">
                        <span class="glyphicon glyphicon-save" ng-click="bundle.downloadBundle($index)"></span>
                    </td>
                    <td>
                        <select ng-model="bundle.copyEnv2[$index]"><option ng-repeat = "env in bundle.environments">{{env}}</option></select>
                        <button ng-click="bundle.copyFile($index)">Copy</button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- for bundle version and ctrl list -->
    <div class="panel panel-default" ng-if="bundle.type === 'Version'">
        <div class="panel-heading clearfix">
            <h4 class="panel-title pull-left">&nbsp;&nbsp;List</h4>
        </div>
        <div class="panel-body">
            <ng-include src="'/components/common-bundle/bundle-list.html'"/>
        </div>
    </div>
</div>